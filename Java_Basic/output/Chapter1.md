## JVM이란?

- Java Virtual Machine의 약자이다.
- Java 프로그램을 실행할 수 있는 가상 머신
  - 여기서 가상머신이란 컴퓨터안에 또 다른 컴퓨터를 동작 시키는것이다.실제로 물리적으로 존재하는 컴퓨터는 아니지만 실제 컴퓨터처럼 작동한다.
  - 시스템가상머신
    - 실제 기계를 대체해서 제공하며, 전체 운영체제를 실행하기 위한 기능들을 제공
  - 프로세스 가상머신
    - 플랫폼에 독립적인 환경에서 컴퓨터 프로그램을 실행하기 위해 고안되었다. 자바!
- JVM이 있기 때문에 Java는 플랫폼 독립적인 코드로 작성,실행될 수 있다.

---

- 일반 프로그램은 OS를 거치면 바로 하드웨어로 전달된다.
- 반면 자바는 JVM을 한번 더 거치고, 실행시 interpret되기 때문에 속도가 다소 느리다.
- 하지만 요즘엔 JIT컴파일러를 통해 바이트코드를 기계어로 바로 변환해주는 덕분에 속도차이를 많이 줄였다.
- 자바 애플리케이션은 OS에 독립적이고 JVM하고만 상호작용한다. 따라서 어떤 OS환경에서도 프로그램 변경없이 실행이 가능하다.

## JVM 구성요소
- Class Loader : 자바 컴파일러에 의해 변환된 바이트코드를 메모리에 로드한다. -> 즉, 클래스를 처음으로 참조할 때 해당 클래스를 load하고 link하는 역할을 수행한다. 단, 클래스 로드는 CompileTime이 아닌 RunTime에 로딩한다.
- Java Interpreter : 바이트코드가 들어오면 명령어 단위로 실행시키는 요소이다 -> 하드웨어에 맞게 완전히 컴파일된 상태가 아니고 실행시 해석되기 때문에 속도가 느리다는 단점을 가지고 있다.
- Execution Engine : Class Loader가 Runtime Data Areas에 불러온 바이트코드를 실행하는데, 인터프리터 방식과 JIT 방식이 있다.
- Garbage Collector : 메모리를 사용하고 실행이 종료되어 다이상 쓰지 않는 객체를 garbage라고 한다. 가비지 콜렉터는 자동으로 메모리를 관리해준다.
- Runtime Data Areas : 프로그램을 실행하기 위해 운영체제로부터 할당받은 공간으로 5가지 영억으로 나눈다.
  - Method Area : JVM이 시작될 때 생성되어 모든 쓰레드가 공유하는 영역이다.
  - Heap : new 연산자로 생성된 객체를 저장하는 공간으로 가비지 콜렉터의 대상이다.
  - Stack : 쓰레드마다 각각 하나씩 존재하며 지역변수, 매개변수 등 매소드 수행 중 발생하는 임시 데이터를 저장한다.
  - PC Register : 쓰레드가 현재 수행중인 명령어의 주소를 갖는다.
  - Native Method : 자바 외의 다른 언어로 작성된 프로그램을 실행시키기 위한 영역이다.

## 컴파일 및 실행하는 방법

- Java로 프로그래밍을 하기 위해서는 JDK(Java Development Kit)를 설치해야 한다. JDK를 설치하면 JVM과 Java API 외 필요한 프로그램들이 설치된다. 
- 설치완료 후 bin 디렉토리에 가면 주요 실행 파일들이 있다.
  - javac.exe 
    - 자바 컴파일러, 자바 소스코드를 바이트코드로 컴파일
  - java.exe
    - 자바 인터프리터, 바이트코드를 해석하고 실행
  - javap.exe
    - 역어셈블러,컴파일된 클래스 파일을 원래소스로 변환

```java
// Hello.java
class Hello {
    public static void main(String[] args) {
        System.out.print("Hello, world !");
    }
}
```
- Hello.java 파일을 실행하는 순서로 
  - 자바 컴파일러를 이용해 소스파일(.java)로 부터 클래스 파일(.class)을 생성한다.
  - 자바 인터프리터로 실행한다.

1. 자바 소스 코드 파일 작성(Hello.java ) ->.java 파일 생성
2. 컴파일(javac) -> javac 명령어를 통해서
3. 자바 바이트 코드(Hello.class) -> .class 생성
4. JVM에서 코드를 해석하고 프로그램을 실행 
5. 프로그램에 따라 컴퓨터가 동작("hello world" 출력)

## 바이트코드란?
- 자바 컴파일러에 의해 소스파일이 바이트코드(.class)로 변환되는데, 이는 컴퓨터가 바로 인식할 수 있다. 즉 JVM이 인식할 수 있는 언어이다. 
- 운영체제와 상관없이 JVM만 있으면 실행되게 하기 위해서다.

## JIT?
- Just-In-Time 의 약자이다.
- 동작과정
  - 소스코드를 컴파일해서 바이트코드로 변환하고, 자바 인터프리터가 이 바이트코드를 기계어로 해석하고 실행한다. -> 이로써 인터프리터의 느린 실행 속도를 개선해 줄 수 있다.
  - 이 작업은 비용이 많이 들기 때문에 이런 단점을 극복하기 위해서 나온것이 JIT이다.
- 같은 코드를 매번 해석하는 대신 자주 쓸만한 코드를 컴파일 해두고 사용한다.
- 실행방식인 Interpreter의 단점을 보완하기 위해 JIT 컴파일러가 도입되어 있지만, 자주 사용되지않은 코드들은 Interpreter 방식이 더 효율적이며 JVM자체 내에서도 해당 메서드들이 어람나 수행되는지 체크하고 , 빈도가 넘었을때 JIT 컴파일러가 실행된다.

## JDK와 JRE 차이
- JDK(Java Development Kit): 자바 개발 도구로 JRE를 포함하고 있습니다.
- JRE(Java Runtime Environment): 자바를 실행하기 위한 환경을 의미합니다.
- JDK는 자바를 개발하기 위한 환경으로 JRE를 포함한다. JRE는 Java Runtime Enviroment의 약자로 자바를 실행시키기 위한 환경으로 JVM을 포함한다.

